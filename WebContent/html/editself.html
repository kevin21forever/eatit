


<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
       

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">
<!-- <link rel="shortcut icon" href="statics/img/favicon.png"> -->


<!-- Bootstrap core CSS -->
<link href="statics/css/bootstrap.min.3.css" rel="stylesheet">
<link href="statics/css/bootstrap-reset.css" rel="stylesheet">
<!--external css-->
<!--<link href="/assets/font-awesomestatics/css/font-awesome.css" rel="stylesheet" />-->
<link href="statics/assets/font-customer/style.css" rel="stylesheet" />

<link href="statics/css/toastr.css" rel="stylesheet"/>

<!-- Custom styles for this template -->
<link href="statics/css/style.css" rel="stylesheet">
<link href="statics/css/style-responsive.css" rel="stylesheet" />






       <title>账号管理</title>
  </head>

  <body>

  <section id="container" >
     

<!--header start-->
<header class="header">
    <div class="sidebar-toggle-box">
        <div data-original-title="切换导航" data-placement="right" class="icon-bon-paragraph-justify tooltips font24" id="mobileMenu"></div>
    </div>
    <!--logo start-->
    	<a class="logo"><span class="icon-bon-logo font36"></span></a>
    <!--logo end-->

    <style>
        .new-pro {
            background-color: #04cce5;
            transform: skew(-20deg);
            height: 90px;
            width: 300px;
            margin: -25px 0 0 44px;
            padding: 10px 5px;
            box-sizing: border-box;
            box-shadow: 0 0 1px 3px rgba(0,0,0,.2) inset;
            cursor: pointer;
        }

        .new-pro-text{
            transform: skew(20deg);
        }
        .npt-line{
            border-right: 2px solid #fff;
            height: 70px;
        }
    </style>

    <div class="top-nav ">
        <!--message info-->
        <ul class="nav pull-left top-menu notify-row">
           <!-- <#include 'include/systemMsg.ftl'> -->
        </ul>
        <!--search & user info start-->

 
        <ul class="nav pull-right top-menu">
            <!-- user login dropdown start-->
        	

<li class="dropdown" >
    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
        <i class="icon-user"></i>
        <span class="username">Lisa Li</span>
        <b class="caret"></b>
    </a>
    <ul class="dropdown-menu extended logout">
        <div class="log-arrow-up"></div>
        <li><a href="loginServlet?action=loginOut"><i class="icon-key"></i>退出</a></li>
    </ul>
</li>
            <!-- user login dropdown end -->
        </ul>
        


<div class="btn-group pull-right">
    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
        <i class="icon-tint cfff"></i>
        <span class="hidden-phone cfff pd-l-5 font16">
        
			
				
          			望湘园(正大店)
   				
 			
				
 			
				
 			
 		
        </span>
        <span class="caret"></span>
    </a>
    <ul class="dropdown-menu" >
    	
	        
	            <li>
	                <a href="/restaurant/loginServlet?action=toUpdate&id=1">
	                <i class="icon-blank"></i>
	                望湘园(正大店)
	                </a>
	            </li>
	        
	            <li>
	                <a href="/restaurant/loginServlet?action=toUpdate&id=2">
	                <i class="icon-blank"></i>
	                57度湘
	                </a>
	            </li>
	        
	            <li>
	                <a href="/restaurant/loginServlet?action=toUpdate&id=4">
	                <i class="icon-blank"></i>
	                上上谦
	                </a>
	            </li>
	        
        
    </ul>
</div> 

<script type="text/javascript">
/**
 * 获取地址栏的参数
 */
function UrlSearch() {
   var name,value; 
   var str = location.href; //取得整个地址栏
   var num = str.indexOf("?"); // 得到"?"所在的位置
   str = str.substr(num + 1); // 取得所有参数   stringvar.substr(start [, length ]

   var arr = str.split("&"); //通过"&"分割各个参数放到数组里
   for(var i = 0;i < arr.length; i++){ 
	    num = arr[i].indexOf("="); // 得到"="所在位置
	    if(num > 0){ 
		     name = arr[i].substring(0,num); // 参数名,从开始到"="的所在位置,不包含"=
		     value = arr[i].substr(num + 1); // 参数值,从"="的所在位置到最后,不包含"="
		     this[name] = value;
	    } 
    } 
} 
var path = window.location.pathname;
var Request = new UrlSearch(); //实例化
var id = Request.id;
var url = path + "?action=info&id=" + id;
</script>

        <!--search & user info end-->
    </div>
</header>
<!--header end-->
<!--sidebar start-->
<aside>
    <div id="sidebar" class="nav-collapse ">
        <!-- sidebar menu start-->
       

<ul class="sidebar-menu" id="nav-accordion">
      <!-- 首页 -->
      <li>
      
          <a   href="indexServlet?id=1">
              <i class="icon-bon-home font34"></i>
              <span>首页</span>
          </a>
      </li>
      
      <!-- 餐厅管理 -->
      <li class="sub-menu">
           <a href="javascript:(0);"  >
               <i class="icon-bon-venue font34"></i>
               <span>餐厅管理</span>
           </a>
           <ul class="sub">
                <li  ><a  href="restaurantServlet?action=info&id=1">餐厅详情</a></li>
                <li  ><a  href="reviewServlet?action=info&id=1">餐厅评论</a></li>
           </ul>
       </li>
       <!-- 促销 -->
       <li>
            <a   href="promotionServlet?action=info&id=1">
                <i class="icon-bon-promo font34"></i>
                <span>优惠促销</span>
            </a>
       </li>
       <!-- 
       <li class="sub-menu">
            <a  href="indexServlet?id=1"  >
                <i class="icon-bon-engagement font34"></i>
                <span>精准营销</span>
            </a>
       </li>
        -->
       <!-- 设置 -->
       <li class="sub-menu">
             <a href="javascript:(0);"  >
                 <i class="icon-bon-settings font34"></i>
                 <span>设置</span>
             </a>
             <ul class="sub">
                <li class="active" >
               		 <a href="loginServlet?action=toUpdate&id=1">我的账号</a>
                </li>
             </ul>
         </li>
    
</ul>
        <!-- sidebar menu end-->
    </div>
</aside>
<!--sidebar end-->



      <!--main content start-->
      <section id="main-content">
          <section class="wrapper">
              <div class="row">
                  <div class="col-lg-12 clearfix">
                      <p class="pull-left font30">编辑信息 </p>
                    
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-12">
                      <section class="panel">
                          <div class="panel-body">
                                  <div class="form-group">
                                      <label class="font16 font-bold">用户邮箱</label>
                                      <input type="email" class="form-control" id="email" placeholder="" value="lisa@sxt.com" readonly="readonly">
                                  </div>
                                  <div class="form-group">
                                      <label class="font16 font-bold">用户名称</label>
                                      <input type="text" class="form-control" id="username" placeholder=""  value="Lisa Li">
                                  </div>
                                  
                                  <div class="form-group">
                                      <label class="font16 font-bold">设置新密码</label>
                                      <input  type="password" class="form-control" id="password" placeholder="">
                                  </div>
                                  <div class="form-group">
                                      <label class="font16 font-bold">重复新密码</label>
                                      <input  type="password" class="form-control" id="repeatpassword" placeholder="">
                                  </div>
                                  
                                  <div class="form-group">
                                      <label class="font16 font-bold">管理的餐厅</label>
                                      
									        
									            <div class="checkbox">
	                                              <label>
	                                                 望湘园(正大店)
	                                              </label>
	                                            </div>
									        
									            <div class="checkbox">
	                                              <label>
	                                                 57度湘
	                                              </label>
	                                            </div>
									        
									            <div class="checkbox">
	                                              <label>
	                                                 上上谦
	                                              </label>
	                                            </div>
									        
								        
                                  </div>
                                  <button type="submit" id='submitBtn' class="btn btn-success" ">修改</button>
                                  <a href="loginServlet?action=toUpdate&id=1">取消</a>

                          </div>
                      </section>
                  </div>
              </div>

          </section>
      </section>
      <!--main content end-->
      <!--footer start-->

<footer class="site-footer">
    <div class="text-center">
    Copyright © 2006-2026 上海尚学堂 All Rights Reserved 电话：021-67690939 QQ：3401997271
        <a href="#" class="go-top">
            <i class="icon-bon-arrow-up"></i>
        </a>
    </div>
</footer>
      <!--footer end-->
  </section>

  

<!-- js placed at the end of the document so the pages load faster -->
<script src="statics/js/jquery-1.8.3.min.js"></script>
<script src="statics/js/bootstrap.min.js"></script>
<script src="statics/js/jquery.scrollTo.min.js"></script>

<!--美化滚动条<script src="statics/js/jquery.nicescroll.js?v=123456" type="text/javascript"></script>-->
<!--<script src="statics/js/jquery.sparkline.js?v=123456" type="text/javascript"></script>-->
<!--<script src="statics/assets/jquery-easy-pie-chart/jquery.easy-pie-chart.js?v=123456"></script>-->
<script src="statics/js/owl.carousel.js" ></script>
<script src="statics/js/jquery.customSelect.min.js" ></script>

<script type="text/javascript" src="statics/js/jquery.dcjqaccordion.2.7.js"></script>
<script src="statics/assets/fancybox/source/jquery.fancybox.js"></script>
<script src="statics/js/respond.min.js" ></script>
<script src="statics/js/modernizr.custom.js"></script>
<script src="statics/js/toucheffects.js"></script>

<!--common script for all pages-->
<script src="statics/js/common-scripts.js"></script>

<!--script for this page-->
<!--<script src="statics/js/easy-pie-chart.js"></script>-->
<script src="statics/js/cookie.util.js"></script>
<script src="statics/js/util.js"></script>
<script src="statics/js/ajax.submit.js"></script>
<script src="statics/js/toastr.js"></script>
<script src="statics/js/bootstrap-paginator.js"></script>
<script src="statics/js/page.js"></script>
<script src="statics/js/bootstrap-confirm.js"></script>

<!--
<footer class="site-footer">
    <div class="text-center">
    Copyright © 2006-2026 上海尚学堂 All Rights Reserved 电话：021-67690939 QQ：3401997271
        <a href="#" class="go-top">
            <i class="icon-bon-arrow-up"></i>
        </a>
    </div>
</footer> -->



  <script>

      //owl carousel

      $(document).ready(function() {
          $("#owl-demo").owlCarousel({
              navigation : true,
              slideSpeed : 300,
              paginationSpeed : 400,
              singleItem : true,
			  autoPlay:true

          });
      });

      //custom select box

      $(function(){
          $('select.styled').customSelect();
      });
        


      $("#submitBtn").click(function() {

          var userName = $("#username").val();
          var email = $('#email').val();
          if (email == null || email == "") {
              toastr["error"]("用户邮箱不能为空!");
              console.log("用户邮箱不能为空！");
              return;
          }
          if (userName == null || userName == "") {
              toastr["error"]("用户名称不能为空!");
              console.log("用户名称不能为空！");
     		  $("#userName").focus();
              return;
          }

          var password = $('#password').val();
          var repeatpassword = $('#repeatpassword').val();
          if ( password != '' || repeatpassword != '' ){
              if ( password == ''){
                  toastr["error"]("新密码不能为空!");
                  return;
              }
              if ( password.length < 6 || password.length > 16){
                  toastr["error"]("新密码长度不能小于六位且不能大于16位!");
                  return;
              }
              if ( repeatpassword == ''){
                  toastr["error"]("重复新密码不能为空!");
                  return;
              }
              if ( repeatpassword.length <6 || repeatpassword.length > 16){
                  toastr["error"]("复新密码长度不能小于六位且不能大于16位!");
                  return;
              }
              if ( password != repeatpassword ){
                  toastr["error"]("新密码和重复新密码不一致！");
                  return;
              }
          }
          
          $(this).confirm({
              'title' : '修改信息',
              'message' : "你确定要修改信息吗？",
              'action' : function(){
            	  
            	  $.ajax({
              		type: "post",
              		url: "loginServlet",
              		data: {"action": "updateUser", "email": email, "userName": userName, "newPassword": password},
              		success : function (data) {
              			console.log(data);
              			$('#flagmodal').modal('hide');
              			if (data == null) {
              				toastr["error"]("系统异常！");
              				console.log("系统异常！");
              				return;
              			}
              			if (data.resultCode != 200) {
              				toastr["error"](data.resultMessage);
              				console.log(data.resultMessage);
              				return;
              			} else {
              				
              				// 如果修改了密码就要重新登录
              				if (password != null || password != "") {
              					toastr["success"]("修改成功！ 密码已变动,请重新登录！");
                  				console.log("修改成功！ 密码已变动,请重新登录！");
              					setTimeout(function(){
        			                //这里的代码将在1000ms(1s后执行)
              						window.location.href = "loginServlet?action=loginOut";
            					},1000);
              					return;
              				} else {
              					toastr["success"]("修改成功！");
                  				console.log("修改成功！");
                  				$('#password').val('');
                  	            $('#repeatpassword').val('');
              				}
              			}
              		}
              	});

              },
              template: '<div class="modal confirm-modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title" id="myLargeModalLabel">Large modal</h4></div><div class="modal-body"><p class="modal-body-content" ></p></div><div class="modal-footer"><button type="button" class="btn btn-default" name="cancelBtn" data-dismiss="modal">取消</button><button type="button"  class="btn btn-danger confirm-btn" name="confirmBtn" data-dismiss="modal">确定</button></div></div></div></div>'
          });
          
 });

  </script>

  </body>
</html>
